VAGRANTFILE_API_VERSION = "2"

Vagrant.configure(VAGRANTFILE_API_VERSION) do |config|
  if ENV["VAGRANT_DEFAULT_PROVIDER"] == "virtualbox"
    # VirtualBox
    config.vm.define :jeos_13_1_build do |jeos_13_1_build|
      jeos_13_1_build.vm.box = "kiwi-build-box"
      jeos_13_1_build.vm.provider :virtualbox do |vb|
        vb.customize ["modifyvm", :id, "--memory", "2048"]
      end
    end
  else
    # docker
    config.vm.provider "docker" do |d|
      # select a docker image from the list, you need to have imported
      # Virtualization:Appliances:Images/docker-box-13.1
      # cat kiwi-docker-image.tar.xz | docker import - kiwi-build-box:new
      d.image = "kiwi-build-box:new"
      d.create_args = ["-privileged=true", "-i", "-t"]
      # start the sshd in foreground to keep the container in running state
      d.cmd = ["/usr/sbin/sshd", "-D"]
      d.has_ssh = true
    end
  end
end
